@page "/"
@model Chirp.Web.Pages.PublicModel
@using System
@{
    ViewData["Title"] = "Chirp!";
    Layout = "Shared/_Layout";
}

<div>
    <h2> Public Timeline </h2>

    @if (User.Identity is not null && User.Identity.IsAuthenticated)
    {
        <div class="cheepbox">
                <h3>What's on your mind @(User.Identity.Name)?</h3>
                <form class="share-cheep" method="post">
                        <textarea type="text" asp-for="NewCheep.Message" required></textarea>
                        <input type="submit" value="Share">
                </form>
        </div>
    }

    @*start cheep loop*@
    @if (Model.DisplayedCheeps.Any())
    {
        <ul id="messagelist" class="cheeps">
            @{
                // this is a foreach loop component with the list of cheeps
                // It's used for displaying the cheeps on the webpage
                // The component can be altered if needed
                // See the CheepList component for more details
                ViewBag.BaseModel = Model;
             
                @await Component.InvokeAsync("CheepList", new { cheeps = Model.DisplayedCheeps })
            }
        </ul>
    }
    else
    {
        <em>There are no cheeps so far.</em>
    }
    
    @*
    Pagination
    The component can be altered if needed
    See the Pagination component for more details
    *@
    @await Component.InvokeAsync("Pagination")
</div>

@*
follow notification popup
The component can be altered if needed
See the FollowNotification component for more details
*@
@await Component.InvokeAsync("FollowNotification")